<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bloom Globe with Rings + Slider</title>
  <style>
    body { margin: 0; overflow: hidden; background: black; }
    #globeViz { width: 100vw; height: 100vh; }
    #sliderContainer {
      position: absolute;
      bottom: 20px;
      width: 100%;
      text-align: center;
      color: white;
      font-size: 1.2em;
    }
    input[type="range"] { width: 60%; }
  </style>
  <script src="https://unpkg.com/globe.gl"></script>
</head>
<body>
  <div id="globeViz"></div>

  <div id="sliderContainer">
    <span id="monthLabel">January</span><br>
    <input type="range" id="monthSlider" min="0" max="11" step="1" value="0">
  </div>

  <script>
    const monthNames = [
      "January","February","March","April","May","June",
      "July","August","September","October","November","December"
    ];

    // ðŸŒ¸ Bloom color palettes for each country (12 colors = 12 months)
    const bloomColors = {
      Japan:      ["#e8eb49","#f5a2ac","#f484d4","#e647b9","#ab8aec","#d56de3","#e898ec","#f399f0","#de4242","#c27d37","#e16473","#f1ebb2"],
      Alaska:     ["#83b1dd","#649ac8","#a2d7ec","#6a5acd","#8f2da0","#d25db9","#cad239","#d9eaa5","#94dee1","#5cabcaff","#34879e","#4b6cb1"],
      Madagascar: ["#2e7d32","#4b9d4f","#6bc56f","#e1a2d6","#8be0dd","#98d6e7","#8ae5e5","#9adbed","#c71585","#edb232","#e2b330","#b288d1"],
      NewZealand: ["#ff1493","#ff1493","#ff8c00","#b22222","#b22222","#778899","#87ceeb","#ffb6c1","#ffff00","#e3e54e","#cb84c9","#b52212"],
      Fiji:       ["#ebe41f","#efa3ee","#e28ee8","#ef6cae","#ea9cd4","#da48c2","#ffffff","#ff4500","#ea8ecb","#edaa92","#eea58b","#e69a87"]
    };

    // ðŸŒ Country coordinates
    const locations = {
      Japan:      { lat: 36.2,  lng: 138.2 },
      Alaska:     { lat: 64.2,  lng: -149.5 },
      Madagascar: { lat: -18.9, lng: 47.5 },
      NewZealand: { lat: -40.9, lng: 174.9 },
      Fiji:       { lat: -17.7, lng: 178.1 }
    };

    // Globe setup
    const GlobeObj = Globe()
      .globeImageUrl('//unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
      .ringMaxRadius(d => d.maxR)
      .ringPropagationSpeed(d => d.speed)
      .ringRepeatPeriod(d => d.period)
      .ringColor(d => t => `rgba(${d.colorRGB[0]},${d.colorRGB[1]},${d.colorRGB[2]},${1 - t})`);

    GlobeObj(document.getElementById('globeViz'));

    GlobeObj.controls().autoRotate = true;
    GlobeObj.controls().autoRotateSpeed = 0.3;

    const numRipples = 12;
    const basePeriod = 12000;

    function hexToRgb(hex) {
      const bigint = parseInt(hex.slice(1), 16);
      return [ (bigint >> 16) & 255, (bigint >> 8) & 255, bigint & 255 ];
    }

    function updateRings(monthIndex) {
      document.getElementById("monthLabel").textContent = monthNames[monthIndex];
      const rings = [];

      for (const country in locations) {
        const { lat, lng } = locations[country];
        const hexColor = bloomColors[country][monthIndex];
        const rgb = hexToRgb(hexColor);

        // multiple overlapping ripples per country
        for (let i = 0; i < numRipples; i++) {
          rings.push({
            lat, lng,
            maxR: 3,
            speed: 2,
            period: basePeriod / (i + 1),
            colorRGB: rgb
          });
        }
      }
      GlobeObj.ringsData(rings);
    }

    // Init
    updateRings(0);

    document.getElementById("monthSlider").addEventListener("input", e => {
      updateRings(parseInt(e.target.value));
    });
  </script>
</body>
</html>
